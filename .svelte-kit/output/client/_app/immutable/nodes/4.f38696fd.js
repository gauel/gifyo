import{S as st,i as dt,s as ut,k as we,a as Ve,q as xe,l as ye,c as _e,m as ke,h as Z,r as Be,n as ae,Y as ft,b as Ae,G as ve,I as qe,C as Qe,R as ct,o as lt,Q as Xe,w as Ze}from"../chunks/index.3ae62e9d.js";const ht=!1,Lt=Object.freeze(Object.defineProperty({__proto__:null,ssr:ht},Symbol.toStringTag,{value:"Module"}));var U=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function pt(T){return T&&T.__esModule&&Object.prototype.hasOwnProperty.call(T,"default")?T.default:T}var $e={exports:{}};(function(T){/**
 * {@link https://github.com/muaz-khan/RecordRTC|RecordRTC} is a WebRTC JavaScript library for audio/video as well as screen activity recording. It supports Chrome, Firefox, Opera, Android, and Microsoft Edge. Platforms: Linux, Mac and Windows. 
 * @summary Record audio, video or screen inside the browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTC
 * @class
 * @example
 * var recorder = RecordRTC(mediaStream or [arrayOfMediaStream], {
 *     type: 'video', // audio or video or gif or canvas
 *     recorderType: MediaStreamRecorder || CanvasRecorder || StereoAudioRecorder || Etc
 * });
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, desiredSampRate: 16000, video: HTMLVideoElement, etc.}
 */function f(i,e){if(!i)throw"First parameter is required.";e=e||{type:"video"},e=new L(i,e);var t=this;function a(o){return e.disableLogs||console.log("RecordRTC version: ",t.version),o&&(e=new L(i,o)),e.disableLogs||console.log("started recording "+e.type+" stream."),l?(l.clearRecordedData(),l.record(),b("recording"),t.recordingDuration&&h(),t):(d(function(){t.recordingDuration&&h()}),t)}function d(o){o&&(e.initCallback=function(){o(),o=e.initCallback=null});var v=new D(i,e);l=new v(i,e),l.record(),b("recording"),e.disableLogs||console.log("Initialized recorderType:",l.constructor.name,"for output-type:",e.type)}function s(o){if(o=o||function(){},!l){g();return}if(t.state==="paused"){t.resumeRecording(),setTimeout(function(){s(o)},1);return}t.state!=="recording"&&!e.disableLogs&&console.warn('Recording state should be: "recording", however current state is: ',t.state),e.disableLogs||console.log("Stopped recording "+e.type+" stream."),e.type!=="gif"?l.stop(v):(l.stop(),v()),b("stopped");function v(S){if(!l){typeof o.call=="function"?o.call(t,""):o("");return}Object.keys(l).forEach(function(y){typeof l[y]!="function"&&(t[y]=l[y])});var n=l.blob;if(!n)if(S)l.blob=n=S;else throw"Recording failed.";if(n&&!e.disableLogs&&console.log(n.type,"->",se(n.size)),o){var u;try{u=I.createObjectURL(n)}catch{}typeof o.call=="function"?o.call(t,u):o(u)}e.autoWriteToDisk&&w(function(y){var R={};R[e.type+"Blob"]=y,de.Store(R)})}}function c(){if(!l){g();return}if(t.state!=="recording"){e.disableLogs||console.warn("Unable to pause the recording. Recording state: ",t.state);return}b("paused"),l.pause(),e.disableLogs||console.log("Paused recording.")}function r(){if(!l){g();return}if(t.state!=="paused"){e.disableLogs||console.warn("Unable to resume the recording. Recording state: ",t.state);return}b("recording"),l.resume(),e.disableLogs||console.log("Resumed recording.")}function p(o){postMessage(new FileReaderSync().readAsDataURL(o))}function w(o,v){if(!o)throw"Pass a callback function over getDataURL.";var S=v?v.blob:(l||{}).blob;if(!S){e.disableLogs||console.warn("Blob encoder did not finish its job yet."),setTimeout(function(){w(o,v)},1e3);return}if(typeof Worker<"u"&&!navigator.mozGetUserMedia){var n=y(p);n.onmessage=function(R){o(R.data)},n.postMessage(S)}else{var u=new FileReader;u.readAsDataURL(S),u.onload=function(R){o(R.target.result)}}function y(R){try{var M=I.createObjectURL(new Blob([R.toString(),"this.onmessage =  function (eee) {"+R.name+"(eee.data);}"],{type:"application/javascript"})),A=new Worker(M);return I.revokeObjectURL(M),A}catch{}}}function h(o){if(o=o||0,t.state==="paused"){setTimeout(function(){h(o)},1e3);return}if(t.state!=="stopped"){if(o>=t.recordingDuration){s(t.onRecordingStopped);return}o+=1e3,setTimeout(function(){h(o)},1e3)}}function b(o){t&&(t.state=o,typeof t.onStateChanged.call=="function"?t.onStateChanged.call(t,o):t.onStateChanged(o))}var m='It seems that recorder is destroyed or "startRecording" is not invoked for '+e.type+" recorder.";function g(){e.disableLogs!==!0&&console.warn(m)}var l,C={startRecording:a,stopRecording:s,pauseRecording:c,resumeRecording:r,initRecorder:d,setRecordingDuration:function(o,v){if(typeof o>"u")throw"recordingDuration is required.";if(typeof o!="number")throw"recordingDuration must be a number.";return t.recordingDuration=o,t.onRecordingStopped=v||function(){},{onRecordingStopped:function(S){t.onRecordingStopped=S}}},clearRecordedData:function(){if(!l){g();return}l.clearRecordedData(),e.disableLogs||console.log("Cleared old recorded data.")},getBlob:function(){if(!l){g();return}return l.blob},getDataURL:w,toURL:function(){if(!l){g();return}return I.createObjectURL(l.blob)},getInternalRecorder:function(){return l},save:function(o){if(!l){g();return}ee(l.blob,o)},getFromDisk:function(o){if(!l){g();return}f.getFromDisk(e.type,o)},setAdvertisementArray:function(o){e.advertisement=[];for(var v=o.length,S=0;S<v;S++)e.advertisement.push({duration:S,image:o[S]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,reset:function(){t.state==="recording"&&!e.disableLogs&&console.warn("Stop an active recorder."),l&&typeof l.clearRecordedData=="function"&&l.clearRecordedData(),l=null,b("inactive"),t.blob=null},onStateChanged:function(o){e.disableLogs||console.log("Recorder state changed:",o)},state:"inactive",getState:function(){return t.state},destroy:function(){var o=e.disableLogs;e={disableLogs:!0},t.reset(),b("destroyed"),C=t=null,E.AudioContextConstructor&&(E.AudioContextConstructor.close(),E.AudioContextConstructor=null),e.disableLogs=o,e.disableLogs||console.log("RecordRTC is destroyed.")},version:"5.6.2"};if(!this)return t=C,C;for(var k in C)this[k]=C[k];return t=this,C}f.version="5.6.2",T.exports=f,f.getFromDisk=function(i,e){if(!e)throw"callback is mandatory.";console.log("Getting recorded "+(i==="all"?"blobs":i+" blob ")+" from disk!"),de.Fetch(function(t,a){i!=="all"&&a===i+"Blob"&&e&&e(t),i==="all"&&e&&e(t,a.replace("Blob",""))})},f.writeToDisk=function(i){console.log("Writing recorded blob(s) to disk!"),i=i||{},i.audio&&i.video&&i.gif?i.audio.getDataURL(function(e){i.video.getDataURL(function(t){i.gif.getDataURL(function(a){de.Store({audioBlob:e,videoBlob:t,gifBlob:a})})})}):i.audio&&i.video?i.audio.getDataURL(function(e){i.video.getDataURL(function(t){de.Store({audioBlob:e,videoBlob:t})})}):i.audio&&i.gif?i.audio.getDataURL(function(e){i.gif.getDataURL(function(t){de.Store({audioBlob:e,gifBlob:t})})}):i.video&&i.gif?i.video.getDataURL(function(e){i.gif.getDataURL(function(t){de.Store({videoBlob:e,gifBlob:t})})}):i.audio?i.audio.getDataURL(function(e){de.Store({audioBlob:e})}):i.video?i.video.getDataURL(function(e){de.Store({videoBlob:e})}):i.gif&&i.gif.getDataURL(function(e){de.Store({gifBlob:e})})};/**
 * {@link RecordRTCConfiguration} is an inner/private helper for {@link RecordRTC}.
 * @summary It configures the 2nd parameter passed over {@link RecordRTC} and returns a valid "config" object.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCConfiguration
 * @class
 * @example
 * var options = RecordRTCConfiguration(mediaStream, options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, getNativeBlob:true, etc.}
 */function L(i,e){return!e.recorderType&&!e.type&&(e.audio&&e.video?e.type="video":e.audio&&!e.video&&(e.type="audio")),e.recorderType&&!e.type&&(e.recorderType===Ue||e.recorderType===Ce||typeof De<"u"&&e.recorderType===De?e.type="video":e.recorderType===Fe?e.type="gif":e.recorderType===Re?e.type="audio":e.recorderType===q&&(B(i,"audio").length&&B(i,"video").length||!B(i,"audio").length&&B(i,"video").length?e.type="video":B(i,"audio").length&&!B(i,"video").length&&(e.type="audio"))),typeof q<"u"&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(e.mimeType||(e.mimeType="video/webm"),e.type||(e.type=e.mimeType.split("/")[0]),e.bitsPerSecond),e.type||(e.mimeType&&(e.type=e.mimeType.split("/")[0]),e.type||(e.type="audio")),e}/**
 * {@link GetRecorderType} is an inner/private helper for {@link RecordRTC}.
 * @summary It returns best recorder-type available for your browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GetRecorderType
 * @class
 * @example
 * var RecorderType = GetRecorderType(options);
 * var recorder = new RecorderType(options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 */function D(i,e){var t;return(Q||W||G)&&(t=Re),typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&!Q&&(t=q),e.type==="video"&&(Q||G)&&(t=Ue,typeof De<"u"&&typeof ReadableStream<"u"&&(t=De)),e.type==="gif"&&(t=Fe),e.type==="canvas"&&(t=Ce),ie()&&t!==Ce&&t!==Fe&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(B(i,"video").length||B(i,"audio").length)&&(e.type==="audio"?typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("audio/webm")&&(t=q):typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("video/webm")&&(t=q)),i instanceof Array&&i.length&&(t=Ye),e.recorderType&&(t=e.recorderType),!e.disableLogs&&t&&t.name&&console.log("Using recorderType:",t.name||t.constructor.name),!t&&he&&(t=q),t}/**
 * MRecordRTC runs on top of {@link RecordRTC} to bring multiple recordings in a single place, by providing simple API.
 * @summary MRecordRTC stands for "Multiple-RecordRTC".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MRecordRTC
 * @class
 * @example
 * var recorder = new MRecordRTC();
 * recorder.addStream(MediaStream);
 * recorder.mediaType = {
 *     audio: true, // or StereoAudioRecorder or MediaStreamRecorder
 *     video: true, // or WhammyRecorder or MediaStreamRecorder or WebAssemblyRecorder or CanvasRecorder
 *     gif: true    // or GifRecorder
 * };
 * // mimeType is optional and should be set only in advance cases.
 * recorder.mimeType = {
 *     audio: 'audio/wav',
 *     video: 'video/webm',
 *     gif:   'image/gif'
 * };
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC/tree/master/MRecordRTC|MRecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @requires {@link RecordRTC}
 */function x(i){this.addStream=function(e){e&&(i=e)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var e=this.mediaType,t,a=this.mimeType||{audio:null,video:null,gif:null};if(typeof e.audio!="function"&&ie()&&!B(i,"audio").length&&(e.audio=!1),typeof e.video!="function"&&ie()&&!B(i,"video").length&&(e.video=!1),typeof e.gif!="function"&&ie()&&!B(i,"video").length&&(e.gif=!1),!e.audio&&!e.video&&!e.gif)throw"MediaStream must have either audio or video tracks.";if(e.audio&&(t=null,typeof e.audio=="function"&&(t=e.audio),this.audioRecorder=new f(i,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:t,mimeType:a.audio,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp}),e.video||this.audioRecorder.startRecording()),e.video){t=null,typeof e.video=="function"&&(t=e.video);var d=i;if(ie()&&e.audio&&typeof e.audio=="function"){var s=B(i,"video")[0];le?(d=new O,d.addTrack(s),t&&t===Ue&&(t=q)):(d=new O,d.addTrack(s))}this.videoRecorder=new f(d,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:t,mimeType:a.video,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp,workerPath:this.workerPath,webAssemblyPath:this.webAssemblyPath,frameRate:this.frameRate,bitrate:this.bitrate}),e.audio||this.videoRecorder.startRecording()}if(e.audio&&e.video){var c=this,r=ie()===!0;(e.audio instanceof Re&&e.video||e.audio!==!0&&e.video!==!0&&e.audio!==e.video)&&(r=!1),r===!0?(c.audioRecorder=null,c.videoRecorder.startRecording()):c.videoRecorder.initRecorder(function(){c.audioRecorder.initRecorder(function(){c.videoRecorder.startRecording(),c.audioRecorder.startRecording()})})}e.gif&&(t=null,typeof e.gif=="function"&&(t=e.gif),this.gifRecorder=new f(i,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:t,mimeType:a.gif}),this.gifRecorder.startRecording())},this.stopRecording=function(e){e=e||function(){},this.audioRecorder&&this.audioRecorder.stopRecording(function(t){e(t,"audio")}),this.videoRecorder&&this.videoRecorder.stopRecording(function(t){e(t,"video")}),this.gifRecorder&&this.gifRecorder.stopRecording(function(t){e(t,"gif")})},this.pauseRecording=function(){this.audioRecorder&&this.audioRecorder.pauseRecording(),this.videoRecorder&&this.videoRecorder.pauseRecording(),this.gifRecorder&&this.gifRecorder.pauseRecording()},this.resumeRecording=function(){this.audioRecorder&&this.audioRecorder.resumeRecording(),this.videoRecorder&&this.videoRecorder.resumeRecording(),this.gifRecorder&&this.gifRecorder.resumeRecording()},this.getBlob=function(e){var t={};return this.audioRecorder&&(t.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(t.video=this.videoRecorder.getBlob()),this.gifRecorder&&(t.gif=this.gifRecorder.getBlob()),e&&e(t),t},this.destroy=function(){this.audioRecorder&&(this.audioRecorder.destroy(),this.audioRecorder=null),this.videoRecorder&&(this.videoRecorder.destroy(),this.videoRecorder=null),this.gifRecorder&&(this.gifRecorder.destroy(),this.gifRecorder=null)},this.getDataURL=function(e){this.getBlob(function(d){d.audio&&d.video?t(d.audio,function(s){t(d.video,function(c){e({audio:s,video:c})})}):d.audio?t(d.audio,function(s){e({audio:s})}):d.video&&t(d.video,function(s){e({video:s})})});function t(d,s){if(typeof Worker<"u"){var c=a(function(w){postMessage(new FileReaderSync().readAsDataURL(w))});c.onmessage=function(p){s(p.data)},c.postMessage(d)}else{var r=new FileReader;r.readAsDataURL(d),r.onload=function(p){s(p.target.result)}}}function a(d){var s=I.createObjectURL(new Blob([d.toString(),"this.onmessage =  function (eee) {"+d.name+"(eee.data);}"],{type:"application/javascript"})),c=new Worker(s),r;if(typeof I<"u")r=I;else if(typeof webkitURL<"u")r=webkitURL;else throw"Neither URL nor webkitURL detected.";return r.revokeObjectURL(s),c}},this.writeToDisk=function(){f.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(e){e=e||{audio:!0,video:!0,gif:!0},e.audio&&this.audioRecorder&&this.audioRecorder.save(typeof e.audio=="string"?e.audio:""),e.video&&this.videoRecorder&&this.videoRecorder.save(typeof e.video=="string"?e.video:""),e.gif&&this.gifRecorder&&this.gifRecorder.save(typeof e.gif=="string"?e.gif:"")}}x.getFromDisk=f.getFromDisk,x.writeToDisk=f.writeToDisk,typeof f<"u"&&(f.MRecordRTC=x);var K="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(i){i&&(typeof window<"u"||typeof U>"u"||(U.navigator={userAgent:K,getUserMedia:function(){}},U.console||(U.console={}),(typeof U.console.log>"u"||typeof U.console.error>"u")&&(U.console.error=U.console.log=U.console.log||function(){console.log(arguments)}),typeof document>"u"&&(i.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function(){return e},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return e},i.HTMLVideoElement=function(){}),typeof location>"u"&&(i.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(i.screen={width:0,height:0}),typeof I>"u"&&(i.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),i.window=U))})(typeof U<"u"?U:null);var F=window.requestAnimationFrame;if(typeof F>"u"){if(typeof webkitRequestAnimationFrame<"u")F=webkitRequestAnimationFrame;else if(typeof mozRequestAnimationFrame<"u")F=mozRequestAnimationFrame;else if(typeof msRequestAnimationFrame<"u")F=msRequestAnimationFrame;else if(typeof F>"u"){var oe=0;F=function(i,e){var t=new Date().getTime(),a=Math.max(0,16-(t-oe)),d=setTimeout(function(){i(t+a)},a);return oe=t+a,d}}}var J=window.cancelAnimationFrame;typeof J>"u"&&(typeof webkitCancelAnimationFrame<"u"?J=webkitCancelAnimationFrame:typeof mozCancelAnimationFrame<"u"?J=mozCancelAnimationFrame:typeof msCancelAnimationFrame<"u"?J=msCancelAnimationFrame:typeof J>"u"&&(J=function(i){clearTimeout(i)}));var _=window.AudioContext;typeof _>"u"&&(typeof webkitAudioContext<"u"&&(_=webkitAudioContext),typeof mozAudioContext<"u"&&(_=mozAudioContext));var I=window.URL;typeof I>"u"&&typeof webkitURL<"u"&&(I=webkitURL),typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var W=navigator.userAgent.indexOf("Edge")!==-1&&(!!navigator.msSaveBlob||!!navigator.msSaveOrOpenBlob),G=!!window.opera||navigator.userAgent.indexOf("OPR/")!==-1,le=navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(navigator.userAgent),Q=!G&&!W&&!!navigator.webkitGetUserMedia||Me()||navigator.userAgent.toLowerCase().indexOf("chrome/")!==-1,he=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);he&&!Q&&navigator.userAgent.indexOf("CriOS")!==-1&&(he=!1,Q=!0);var O=window.MediaStream;typeof O>"u"&&typeof webkitMediaStream<"u"&&(O=webkitMediaStream),typeof O<"u"&&typeof O.prototype.stop>"u"&&(O.prototype.stop=function(){this.getTracks().forEach(function(i){i.stop()})});function se(i){var e=1e3,t=["Bytes","KB","MB","GB","TB"];if(i===0)return"0 Bytes";var a=parseInt(Math.floor(Math.log(i)/Math.log(e)),10);return(i/Math.pow(e,a)).toPrecision(3)+" "+t[a]}function ee(i,e){if(!i)throw"Blob object is required.";if(!i.type)try{i.type="video/webm"}catch{}var t=(i.type||"video/webm").split("/")[1];if(t.indexOf(";")!==-1&&(t=t.split(";")[0]),e&&e.indexOf(".")!==-1){var a=e.split(".");e=a[0],t=a[1]}var d=(e||Math.round(Math.random()*9999999999)+888888888)+"."+t;if(typeof navigator.msSaveOrOpenBlob<"u")return navigator.msSaveOrOpenBlob(i,d);if(typeof navigator.msSaveBlob<"u")return navigator.msSaveBlob(i,d);var s=document.createElement("a");s.href=I.createObjectURL(i),s.download=d,s.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(s),typeof s.click=="function"?s.click():(s.target="_blank",s.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),I.revokeObjectURL(s.href)}function Me(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}function B(i,e){return!i||!i.getTracks?[]:i.getTracks().filter(function(t){return t.kind===(e||"audio")})}function te(i,e){"srcObject"in e?e.srcObject=i:"mozSrcObject"in e?e.mozSrcObject=i:e.srcObject=i}function P(i,e){if(typeof EBML>"u")throw new Error("Please link: https://www.webrtc-experiment.com/EBML.js");var t=new EBML.Reader,a=new EBML.Decoder,d=EBML.tools,s=new FileReader;s.onload=function(c){var r=a.decode(this.result);r.forEach(function(b){t.read(b)}),t.stop();var p=d.makeMetadataSeekable(t.metadatas,t.duration,t.cues),w=this.result.slice(t.metadataSize),h=new Blob([p,w],{type:"video/webm"});e(h)},s.readAsArrayBuffer(i)}typeof f<"u"&&(f.invokeSaveAsDialog=ee,f.getTracks=B,f.getSeekableBlob=P,f.bytesToSize=se,f.isElectron=Me);/**
 * Storage is a standalone object used by {@link RecordRTC} to store reusable objects e.g. "new AudioContext".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * Storage.AudioContext === webkitAudioContext
 * @property {webkitAudioContext} AudioContext - Keeps a reference to AudioContext object.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var E={};typeof _<"u"?E.AudioContext=_:typeof webkitAudioContext<"u"&&(E.AudioContext=webkitAudioContext),typeof f<"u"&&(f.Storage=E);function ie(){if(le||he||W)return!0;var i=navigator.userAgent,e=""+parseFloat(navigator.appVersion),t=parseInt(navigator.appVersion,10),a,d;return(Q||G)&&(a=i.indexOf("Chrome"),e=i.substring(a+7)),(d=e.indexOf(";"))!==-1&&(e=e.substring(0,d)),(d=e.indexOf(" "))!==-1&&(e=e.substring(0,d)),t=parseInt(""+e,10),isNaN(t)&&(e=""+parseFloat(navigator.appVersion),t=parseInt(navigator.appVersion,10)),t>=49}/**
 * MediaStreamRecorder is an abstraction layer for {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}. It is used by {@link RecordRTC} to record MediaStream(s) in both Chrome and Firefox.
 * @summary Runs top over {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://github.com/muaz-khan|Muaz Khan}
 * @typedef MediaStreamRecorder
 * @class
 * @example
 * var config = {
 *     mimeType: 'video/webm', // vp8, vp9, h264, mkv, opus/vorbis
 *     audioBitsPerSecond : 256 * 8 * 1024,
 *     videoBitsPerSecond : 256 * 8 * 1024,
 *     bitsPerSecond: 256 * 8 * 1024,  // if this is provided, skip above two
 *     checkForInactiveTracks: true,
 *     timeSlice: 1000, // concatenate intervals based blobs
 *     ondataavailable: function() {} // get intervals based blobs
 * }
 * var recorder = new MediaStreamRecorder(mediaStream, config);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs:true, initCallback: function, mimeType: "video/webm", timeSlice: 1000}
 * @throws Will throw an error if first argument "MediaStream" is missing. Also throws error if "MediaRecorder API" are not supported by the browser.
 */function q(i,e){var h=this;if(typeof i>"u")throw'First argument "MediaStream" is required.';if(typeof MediaRecorder>"u")throw"Your browser does not support the Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.";if(e=e||{mimeType:"video/webm"},e.type==="audio"){if(B(i,"video").length&&B(i,"audio").length){var t;navigator.mozGetUserMedia?(t=new O,t.addTrack(B(i,"audio")[0])):t=new O(B(i,"audio")),i=t}(!e.mimeType||e.mimeType.toString().toLowerCase().indexOf("audio")===-1)&&(e.mimeType=Q?"audio/webm":"audio/ogg"),e.mimeType&&e.mimeType.toString().toLowerCase()!=="audio/ogg"&&navigator.mozGetUserMedia&&(e.mimeType="audio/ogg")}var a=[];this.getArrayOfBlobs=function(){return a},this.record=function(){h.blob=null,h.clearRecordedData(),h.timestamps=[],w=[],a=[];var b=e;e.disableLogs||console.log("Passing following config over MediaRecorder API.",b),r&&(r=null),Q&&!ie()&&(b="video/vp8"),typeof MediaRecorder.isTypeSupported=="function"&&b.mimeType&&(MediaRecorder.isTypeSupported(b.mimeType)||(e.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",b.mimeType),b.mimeType=e.type==="audio"?"audio/webm":"video/webm"));try{r=new MediaRecorder(i,b),e.mimeType=b.mimeType}catch{r=new MediaRecorder(i)}b.mimeType&&!MediaRecorder.isTypeSupported&&"canRecordMimeType"in r&&r.canRecordMimeType(b.mimeType)===!1&&(e.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",b.mimeType)),r.ondataavailable=function(m){if(m.data&&w.push("ondataavailable: "+se(m.data.size)),typeof e.timeSlice=="number"){if(m.data&&m.data.size&&(a.push(m.data),d(),typeof e.ondataavailable=="function")){var g=e.getNativeBlob?m.data:new Blob([m.data],{type:s(b)});e.ondataavailable(g)}return}if(!m.data||!m.data.size||m.data.size<100||h.blob){h.recordingCallback&&(h.recordingCallback(new Blob([],{type:s(b)})),h.recordingCallback=null);return}h.blob=e.getNativeBlob?m.data:new Blob([m.data],{type:s(b)}),h.recordingCallback&&(h.recordingCallback(h.blob),h.recordingCallback=null)},r.onstart=function(){w.push("started")},r.onpause=function(){w.push("paused")},r.onresume=function(){w.push("resumed")},r.onstop=function(){w.push("stopped")},r.onerror=function(m){m&&(m.name||(m.name="UnknownError"),w.push("error: "+m),e.disableLogs||(m.name.toString().toLowerCase().indexOf("invalidstate")!==-1?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.",m):m.name.toString().toLowerCase().indexOf("notsupported")!==-1?console.error("MIME type (",b.mimeType,") is not supported.",m):m.name.toString().toLowerCase().indexOf("security")!==-1?console.error("MediaRecorder security error",m):m.name==="OutOfMemory"?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.",m):m.name==="IllegalStreamModification"?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.",m):m.name==="OtherRecordingError"?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.",m):m.name==="GenericError"?console.error("The UA cannot provide the codec or recording option that has been requested.",m):console.error("MediaRecorder Error",m)),function(g){if(!h.manuallyStopped&&r&&r.state==="inactive"){delete e.timeslice,r.start(10*60*1e3);return}setTimeout(g,1e3)}(),r.state!=="inactive"&&r.state!=="stopped"&&r.stop())},typeof e.timeSlice=="number"?(d(),r.start(e.timeSlice)):r.start(36e5),e.initCallback&&e.initCallback()},this.timestamps=[];function d(){h.timestamps.push(new Date().getTime()),typeof e.onTimeStamp=="function"&&e.onTimeStamp(h.timestamps[h.timestamps.length-1],h.timestamps)}function s(b){return r&&r.mimeType?r.mimeType:b.mimeType||"video/webm"}this.stop=function(b){b=b||function(){},h.manuallyStopped=!0,r&&(this.recordingCallback=b,r.state==="recording"&&r.stop(),typeof e.timeSlice=="number"&&setTimeout(function(){h.blob=new Blob(a,{type:s(e)}),h.recordingCallback(h.blob)},100))},this.pause=function(){r&&r.state==="recording"&&r.pause()},this.resume=function(){r&&r.state==="paused"&&r.resume()},this.clearRecordedData=function(){r&&r.state==="recording"&&h.stop(c),c()};function c(){a=[],r=null,h.timestamps=[]}var r;this.getInternalRecorder=function(){return r};function p(){if("active"in i){if(!i.active)return!1}else if("ended"in i&&i.ended)return!1;return!0}this.blob=null,this.getState=function(){return r&&r.state||"inactive"};var w=[];this.getAllStates=function(){return w},typeof e.checkForInactiveTracks>"u"&&(e.checkForInactiveTracks=!1);var h=this;(function b(){if(!(!r||e.checkForInactiveTracks===!1)){if(p()===!1){e.disableLogs||console.log("MediaStream seems stopped."),h.stop();return}setTimeout(b,1e3)}})(),this.name="MediaStreamRecorder",this.toString=function(){return this.name}}typeof f<"u"&&(f.MediaStreamRecorder=q);/**
 * StereoAudioRecorder is a standalone class used by {@link RecordRTC} to bring "stereo" audio-recording in chrome.
 * @summary JavaScript standalone object for stereo audio recording.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef StereoAudioRecorder
 * @class
 * @example
 * var recorder = new StereoAudioRecorder(MediaStream, {
 *     sampleRate: 44100,
 *     bufferSize: 4096
 * });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {sampleRate: 44100, bufferSize: 4096, numberOfAudioChannels: 1, etc.}
 */function Re(i,e){if(!B(i,"audio").length)throw"Your stream has no audio tracks.";e=e||{};var t=this,a=[],d=[],s=!1,c=0,r,p=2,w=e.desiredSampRate;e.leftChannel===!0&&(p=1),e.numberOfAudioChannels===1&&(p=1),(!p||p<1)&&(p=2),e.disableLogs||console.log("StereoAudioRecorder is set to record number of channels: "+p),typeof e.checkForInactiveTracks>"u"&&(e.checkForInactiveTracks=!0);function h(){if(e.checkForInactiveTracks===!1)return!0;if("active"in i){if(!i.active)return!1}else if("ended"in i&&i.ended)return!1;return!0}this.record=function(){if(h()===!1)throw"Please make sure MediaStream is active.";S(),u=v=!1,s=!0,typeof e.timeSlice<"u"&&M()};function b(A,H){function j(z,Le){var ue=z.numberOfAudioChannels,X=z.leftBuffers.slice(0),be=z.rightBuffers.slice(0),fe=z.sampleRate,pe=z.internalInterleavedLength,$=z.desiredSampRate;ue===2&&(X=ze(X,pe),be=ze(be,pe),$&&(X=Se(X,$,fe),be=Se(be,$,fe))),ue===1&&(X=ze(X,pe),$&&(X=Se(X,$,fe))),$&&(fe=$);function Se(N,ce,re){var ne=Math.round(N.length*(ce/re)),Y=[],me=Number((N.length-1)/(ne-1));Y[0]=N[0];for(var Te=1;Te<ne-1;Te++){var Ge=Te*me,Je=Number(Math.floor(Ge)).toFixed(),ot=Number(Math.ceil(Ge)).toFixed(),at=Ge-Je;Y[Te]=je(N[Je],N[ot],at)}return Y[ne-1]=N[N.length-1],Y}function je(N,ce,re){return N+(ce-N)*re}function ze(N,ce){for(var re=new Float64Array(ce),ne=0,Y=N.length,me=0;me<Y;me++){var Te=N[me];re.set(Te,ne),ne+=Te.length}return re}function tt(N,ce){for(var re=N.length+ce.length,ne=new Float64Array(re),Y=0,me=0;me<re;)ne[me++]=N[Y],ne[me++]=ce[Y],Y++;return ne}function Ie(N,ce,re){for(var ne=re.length,Y=0;Y<ne;Y++)N.setUint8(ce+Y,re.charCodeAt(Y))}var Oe;ue===2&&(Oe=tt(X,be)),ue===1&&(Oe=X);var Ee=Oe.length,it=44+Ee*2,Ne=new ArrayBuffer(it),V=new DataView(Ne);Ie(V,0,"RIFF"),V.setUint32(4,36+Ee*2,!0),Ie(V,8,"WAVE"),Ie(V,12,"fmt "),V.setUint32(16,16,!0),V.setUint16(20,1,!0),V.setUint16(22,ue,!0),V.setUint32(24,fe,!0),V.setUint32(28,fe*ue*2,!0),V.setUint16(32,ue*2,!0),V.setUint16(34,16,!0),Ie(V,36,"data"),V.setUint32(40,Ee*2,!0);for(var rt=Ee,Ke=44,nt=1,We=0;We<rt;We++)V.setInt16(Ke,Oe[We]*(32767*nt),!0),Ke+=2;if(Le)return Le({buffer:Ne,view:V});postMessage({buffer:Ne,view:V})}if(A.noWorker){j(A,function(z){H(z.buffer,z.view)});return}var ge=m(j);ge.onmessage=function(z){H(z.data.buffer,z.data.view),I.revokeObjectURL(ge.workerURL),ge.terminate()},ge.postMessage(A)}function m(A){var H=I.createObjectURL(new Blob([A.toString(),";this.onmessage =  function (eee) {"+A.name+"(eee.data);}"],{type:"application/javascript"})),j=new Worker(H);return j.workerURL=H,j}this.stop=function(A){A=A||function(){},s=!1,b({desiredSampRate:w,sampleRate:o,numberOfAudioChannels:p,internalInterleavedLength:c,leftBuffers:a,rightBuffers:p===1?[]:d,noWorker:e.noWorker},function(H,j){t.blob=new Blob([j],{type:"audio/wav"}),t.buffer=new ArrayBuffer(j.buffer.byteLength),t.view=j,t.sampleRate=w||o,t.bufferSize=k,t.length=c,u=!1,A&&A(t.blob)})},typeof f.Storage>"u"&&(f.Storage={AudioContextConstructor:null,AudioContext:window.AudioContext||window.webkitAudioContext}),(!f.Storage.AudioContextConstructor||f.Storage.AudioContextConstructor.state==="closed")&&(f.Storage.AudioContextConstructor=new f.Storage.AudioContext);var g=f.Storage.AudioContextConstructor,l=g.createMediaStreamSource(i),C=[0,256,512,1024,2048,4096,8192,16384],k=typeof e.bufferSize>"u"?4096:e.bufferSize;if(C.indexOf(k)===-1&&(e.disableLogs||console.log("Legal values for buffer-size are "+JSON.stringify(C,null,"	"))),g.createJavaScriptNode)r=g.createJavaScriptNode(k,p,p);else if(g.createScriptProcessor)r=g.createScriptProcessor(k,p,p);else throw"WebAudio API has no support on this browser.";l.connect(r),e.bufferSize||(k=r.bufferSize);var o=typeof e.sampleRate<"u"?e.sampleRate:g.sampleRate||44100;(o<22050||o>96e3)&&(e.disableLogs||console.log("sample-rate must be under range 22050 and 96000.")),e.disableLogs||e.desiredSampRate&&console.log("Desired sample-rate: "+e.desiredSampRate);var v=!1;this.pause=function(){v=!0},this.resume=function(){if(h()===!1)throw"Please make sure MediaStream is active.";if(!s){e.disableLogs||console.log("Seems recording has been restarted."),this.record();return}v=!1},this.clearRecordedData=function(){e.checkForInactiveTracks=!1,s&&this.stop(n),n()};function S(){a=[],d=[],c=0,u=!1,s=!1,v=!1,g=null,t.leftchannel=a,t.rightchannel=d,t.numberOfAudioChannels=p,t.desiredSampRate=w,t.sampleRate=o,t.recordingLength=c,R={left:[],right:[],recordingLength:0}}function n(){r&&(r.onaudioprocess=null,r.disconnect(),r=null),l&&(l.disconnect(),l=null),S()}this.name="StereoAudioRecorder",this.toString=function(){return this.name};var u=!1;function y(A){if(!v){if(h()===!1&&(e.disableLogs||console.log("MediaStream seems stopped."),r.disconnect(),s=!1),!s){l&&(l.disconnect(),l=null);return}u||(u=!0,e.onAudioProcessStarted&&e.onAudioProcessStarted(),e.initCallback&&e.initCallback());var H=A.inputBuffer.getChannelData(0),j=new Float32Array(H);if(a.push(j),p===2){var ge=A.inputBuffer.getChannelData(1),z=new Float32Array(ge);d.push(z)}c+=k,t.recordingLength=c,typeof e.timeSlice<"u"&&(R.recordingLength+=k,R.left.push(j),p===2&&R.right.push(z))}}r.onaudioprocess=y,g.createMediaStreamDestination?r.connect(g.createMediaStreamDestination()):r.connect(g.destination),this.leftchannel=a,this.rightchannel=d,this.numberOfAudioChannels=p,this.desiredSampRate=w,this.sampleRate=o,t.recordingLength=c;var R={left:[],right:[],recordingLength:0};function M(){!s||typeof e.ondataavailable!="function"||typeof e.timeSlice>"u"||(R.left.length?(b({desiredSampRate:w,sampleRate:o,numberOfAudioChannels:p,internalInterleavedLength:R.recordingLength,leftBuffers:R.left,rightBuffers:p===1?[]:R.right},function(A,H){var j=new Blob([H],{type:"audio/wav"});e.ondataavailable(j),setTimeout(M,e.timeSlice)}),R={left:[],right:[],recordingLength:0}):setTimeout(M,e.timeSlice))}}typeof f<"u"&&(f.StereoAudioRecorder=Re);/**
 * CanvasRecorder is a standalone class used by {@link RecordRTC} to bring HTML5-Canvas recording into video WebM. It uses HTML2Canvas library and runs top over {@link Whammy}.
 * @summary HTML2Canvas recording into video WebM.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef CanvasRecorder
 * @class
 * @example
 * var recorder = new CanvasRecorder(htmlElement, { disableLogs: true, useWhammyRecorder: true });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {HTMLElement} htmlElement - querySelector/getElementById/getElementsByTagName[0]/etc.
 * @param {object} config - {disableLogs:true, initCallback: function}
 */function Ce(i,e){if(typeof html2canvas>"u")throw"Please link: https://www.webrtc-experiment.com/screenshot.js";e=e||{},e.frameInterval||(e.frameInterval=10);var t=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(C){C in document.createElement("canvas")&&(t=!0)});var a=(!!window.webkitRTCPeerConnection||!!window.webkitGetUserMedia)&&!!window.chrome,d=50,s=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);a&&s&&s[2]&&(d=parseInt(s[2],10)),a&&d<52&&(t=!1),e.useWhammyRecorder&&(t=!1);var c,r;if(t)if(e.disableLogs||console.log("Your browser supports both MediRecorder API and canvas.captureStream!"),i instanceof HTMLCanvasElement)c=i;else if(i instanceof CanvasRenderingContext2D)c=i.canvas;else throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";else navigator.mozGetUserMedia&&(e.disableLogs||console.error("Canvas recording is NOT supported in Firefox."));var p;this.record=function(){if(p=!0,t&&!e.useWhammyRecorder){var C;"captureStream"in c?C=c.captureStream(25):"mozCaptureStream"in c?C=c.mozCaptureStream(25):"webkitCaptureStream"in c&&(C=c.webkitCaptureStream(25));try{var k=new O;k.addTrack(B(C,"video")[0]),C=k}catch{}if(!C)throw"captureStream API are NOT available.";r=new q(C,{mimeType:e.mimeType||"video/webm"}),r.record()}else l.frames=[],g=new Date().getTime(),m();e.initCallback&&e.initCallback()},this.getWebPImages=function(C){if(i.nodeName.toLowerCase()!=="canvas"){C();return}var k=l.frames.length;l.frames.forEach(function(o,v){var S=k-v;e.disableLogs||console.log(S+"/"+k+" frames remaining"),e.onEncodingCallback&&e.onEncodingCallback(S,k);var n=o.image.toDataURL("image/webp",1);l.frames[v].image=n}),e.disableLogs||console.log("Generating WebM"),C()},this.stop=function(C){p=!1;var k=this;if(t&&r){r.stop(C);return}this.getWebPImages(function(){l.compile(function(o){e.disableLogs||console.log("Recording finished!"),k.blob=o,k.blob.forEach&&(k.blob=new Blob([],{type:"video/webm"})),C&&C(k.blob),l.frames=[]})})};var w=!1;this.pause=function(){if(w=!0,r instanceof q){r.pause();return}},this.resume=function(){if(w=!1,r instanceof q){r.resume();return}p||this.record()},this.clearRecordedData=function(){p&&this.stop(h),h()};function h(){l.frames=[],p=!1,w=!1}this.name="CanvasRecorder",this.toString=function(){return this.name};function b(){var C=document.createElement("canvas"),k=C.getContext("2d");return C.width=i.width,C.height=i.height,k.drawImage(i,0,0),C}function m(){if(w)return g=new Date().getTime(),setTimeout(m,500);if(i.nodeName.toLowerCase()==="canvas"){var C=new Date().getTime()-g;g=new Date().getTime(),l.frames.push({image:b(),duration:C}),p&&setTimeout(m,e.frameInterval);return}html2canvas(i,{grabMouse:typeof e.showMousePointer>"u"||e.showMousePointer,onrendered:function(k){var o=new Date().getTime()-g;if(!o)return setTimeout(m,e.frameInterval);g=new Date().getTime(),l.frames.push({image:k.toDataURL("image/webp",1),duration:o}),p&&setTimeout(m,e.frameInterval)}})}var g=new Date().getTime(),l=new Pe.Video(100)}typeof f<"u"&&(f.CanvasRecorder=Ce);/**
 * WhammyRecorder is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It runs top over {@link Whammy}.
 * @summary Video recording feature in Chrome.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WhammyRecorder
 * @class
 * @example
 * var recorder = new WhammyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs: true, initCallback: function, video: HTMLVideoElement, etc.}
 */function Ue(i,e){e=e||{},e.frameInterval||(e.frameInterval=10),e.disableLogs||console.log("Using frames-interval:",e.frameInterval),this.record=function(){e.width||(e.width=320),e.height||(e.height=240),e.video||(e.video={width:e.width,height:e.height}),e.canvas||(e.canvas={width:e.width,height:e.height}),p.width=e.canvas.width||320,p.height=e.canvas.height||240,w=p.getContext("2d"),e.video&&e.video instanceof HTMLVideoElement?(h=e.video.cloneNode(),e.initCallback&&e.initCallback()):(h=document.createElement("video"),te(i,h),h.onloadedmetadata=function(){e.initCallback&&e.initCallback()},h.width=e.video.width,h.height=e.video.height),h.muted=!0,h.play(),b=new Date().getTime(),m=new Pe.Video,e.disableLogs||(console.log("canvas resolutions",p.width,"*",p.height),console.log("video width/height",h.width||p.width,"*",h.height||p.height)),t(e.frameInterval)};function t(g){g=typeof g<"u"?g:10;var l=new Date().getTime()-b;if(!l)return setTimeout(t,g,g);if(c)return b=new Date().getTime(),setTimeout(t,100);b=new Date().getTime(),h.paused&&h.play(),w.drawImage(h,0,0,p.width,p.height),m.frames.push({duration:l,image:p.toDataURL("image/webp")}),s||setTimeout(t,g,g)}function a(g){var l=-1,C=g.length;(function k(){if(l++,l===C){g.callback();return}setTimeout(function(){g.functionToLoop(k,l)},1)})()}function d(g,l,C,k,o){var v=document.createElement("canvas");v.width=p.width,v.height=p.height;var S=v.getContext("2d"),n=[],u=l===-1,y=l&&l>0&&l<=g.length?l:g.length,R={r:0,g:0,b:0},M=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),A=C&&C>=0&&C<=1?C:0,H=k&&k>=0&&k<=1?k:0,j=!1;a({length:y,functionToLoop:function(ge,z){var Le,ue,X,be=function(){!j&&X-Le<=X*H||(u&&(j=!0),n.push(g[z])),ge()};if(j)be();else{var fe=new Image;fe.onload=function(){S.drawImage(fe,0,0,p.width,p.height);var pe=S.getImageData(0,0,p.width,p.height);Le=0,ue=pe.data.length,X=pe.data.length/4;for(var $=0;$<ue;$+=4){var Se={r:pe.data[$],g:pe.data[$+1],b:pe.data[$+2]},je=Math.sqrt(Math.pow(Se.r-R.r,2)+Math.pow(Se.g-R.g,2)+Math.pow(Se.b-R.b,2));je<=M*A&&Le++}be()},fe.src=g[z].image}},callback:function(){n=n.concat(g.slice(y)),n.length<=0&&n.push(g[g.length-1]),o(n)}})}var s=!1;this.stop=function(g){g=g||function(){},s=!0;var l=this;setTimeout(function(){d(m.frames,-1,null,null,function(C){m.frames=C,e.advertisement&&e.advertisement.length&&(m.frames=e.advertisement.concat(m.frames)),m.compile(function(k){l.blob=k,l.blob.forEach&&(l.blob=new Blob([],{type:"video/webm"})),g&&g(l.blob)})})},10)};var c=!1;this.pause=function(){c=!0},this.resume=function(){c=!1,s&&this.record()},this.clearRecordedData=function(){s||this.stop(r),r()};function r(){m.frames=[],s=!0,c=!1}this.name="WhammyRecorder",this.toString=function(){return this.name};var p=document.createElement("canvas"),w=p.getContext("2d"),h,b,m}typeof f<"u"&&(f.WhammyRecorder=Ue);/**
 * Whammy is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It is written by {@link https://github.com/antimatter15|antimatter15}
 * @summary A real time javascript webm encoder based on a canvas hack.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef Whammy
 * @class
 * @example
 * var recorder = new Whammy().Video(15);
 * recorder.add(context || canvas || dataURL);
 * var output = recorder.compile();
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var Pe=function(){function i(a){this.frames=[],this.duration=a||1,this.quality=.8}i.prototype.add=function(a,d){if("canvas"in a&&(a=a.canvas),"toDataURL"in a&&(a=a.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/ig.test(a))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:a,duration:d||this.duration})};function e(a){var d=I.createObjectURL(new Blob([a.toString(),"this.onmessage =  function (eee) {"+a.name+"(eee.data);}"],{type:"application/javascript"})),s=new Worker(d);return I.revokeObjectURL(d),s}function t(a){function d(o){var v=c(o);if(!v)return[];for(var S=3e4,n=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:C(v.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:v.width,id:176},{data:v.height,id:186}]}]}]}]}],u=0,y=0;u<o.length;){var R=[],M=0;do R.push(o[u]),M+=o[u].duration,u++;while(u<o.length&&M<S);var A=0,H={id:524531317,data:s(y,A,R)};n[1].data.push(H),y+=M}return h(n)}function s(o,v,S){return[{data:o,id:231}].concat(S.map(function(n){var u=b({discardable:0,frame:n.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(v)});return v+=n.duration,{data:u,id:163}}))}function c(o){if(!o[0]){postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});return}for(var v=o[0].width,S=o[0].height,n=o[0].duration,u=1;u<o.length;u++)n+=o[u].duration;return{duration:n,width:v,height:S}}function r(o){for(var v=[];o>0;)v.push(o&255),o=o>>8;return new Uint8Array(v.reverse())}function p(o){return new Uint8Array(o.split("").map(function(v){return v.charCodeAt(0)}))}function w(o){var v=[],S=o.length%8?new Array(9-o.length%8).join("0"):"";o=S+o;for(var n=0;n<o.length;n+=8)v.push(parseInt(o.substr(n,8),2));return new Uint8Array(v)}function h(o){for(var v=[],S=0;S<o.length;S++){var n=o[S].data;typeof n=="object"&&(n=h(n)),typeof n=="number"&&(n=w(n.toString(2))),typeof n=="string"&&(n=p(n));var u=n.size||n.byteLength||n.length,y=Math.ceil(Math.ceil(Math.log(u)/Math.log(2))/8),R=u.toString(2),M=new Array(y*7+7+1-R.length).join("0")+R,A=new Array(y).join("0")+"1"+M;v.push(r(o[S].id)),v.push(w(A)),v.push(n)}return new Blob(v,{type:"video/webm"})}function b(o){var v=0;if(o.keyframe&&(v|=128),o.invisible&&(v|=8),o.lacing&&(v|=o.lacing<<1),o.discardable&&(v|=1),o.trackNum>127)throw"TrackNumber > 127 not supported";var S=[o.trackNum|128,o.timecode>>8,o.timecode&255,v].map(function(n){return String.fromCharCode(n)}).join("")+o.frame;return S}function m(o){for(var v=o.RIFF[0].WEBP[0],S=v.indexOf("¬ù*"),n=0,u=[];n<4;n++)u[n]=v.charCodeAt(S+3+n);var y,R,M;return M=u[1]<<8|u[0],y=M&16383,M=u[3]<<8|u[2],R=M&16383,{width:y,height:R,data:v,riff:o}}function g(o,v){return parseInt(o.substr(v+4,4).split("").map(function(S){var n=S.charCodeAt(0).toString(2);return new Array(8-n.length+1).join("0")+n}).join(""),2)}function l(o){for(var v=0,S={};v<o.length;){var n=o.substr(v,4),u=g(o,v),y=o.substr(v+4+4,u);v+=4+4+u,S[n]=S[n]||[],n==="RIFF"||n==="LIST"?S[n].push(l(y)):S[n].push(y)}return S}function C(o){return[].slice.call(new Uint8Array(new Float64Array([o]).buffer),0).map(function(v){return String.fromCharCode(v)}).reverse().join("")}var k=new d(a.map(function(o){var v=m(l(atob(o.image.slice(23))));return v.duration=o.duration,v}));postMessage(k)}return i.prototype.compile=function(a){var d=e(t);d.onmessage=function(s){if(s.data.error){console.error(s.data.error);return}a(s.data)},d.postMessage(this.frames)},{Video:i}}();typeof f<"u"&&(f.Whammy=Pe);/**
 * DiskStorage is a standalone object used by {@link RecordRTC} to store recorded blobs in IndexedDB storage.
 * @summary Writing blobs into IndexedDB.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * DiskStorage.Store({
 *     audioBlob: yourAudioBlob,
 *     videoBlob: yourVideoBlob,
 *     gifBlob  : yourGifBlob
 * });
 * DiskStorage.Fetch(function(dataURL, type) {
 *     if(type === 'audioBlob') { }
 *     if(type === 'videoBlob') { }
 *     if(type === 'gifBlob')   { }
 * });
 * // DiskStorage.dataStoreName = 'recordRTC';
 * // DiskStorage.onError = function(error) { };
 * @property {function} init - This method must be called once to initialize IndexedDB ObjectStore. Though, it is auto-used internally.
 * @property {function} Fetch - This method fetches stored blobs from IndexedDB.
 * @property {function} Store - This method stores blobs in IndexedDB.
 * @property {function} onError - This function is invoked for any known/unknown error.
 * @property {string} dataStoreName - Name of the ObjectStore created in IndexedDB storage.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var de={init:function(){var i=this;if(typeof indexedDB>"u"||typeof indexedDB.open>"u"){console.error("IndexedDB API are not available in this browser.");return}var e=1,t=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),a,d=indexedDB.open(t,e);function s(r){r.createObjectStore(i.dataStoreName)}function c(){var r=a.transaction([i.dataStoreName],"readwrite");i.videoBlob&&r.objectStore(i.dataStoreName).put(i.videoBlob,"videoBlob"),i.gifBlob&&r.objectStore(i.dataStoreName).put(i.gifBlob,"gifBlob"),i.audioBlob&&r.objectStore(i.dataStoreName).put(i.audioBlob,"audioBlob");function p(w){r.objectStore(i.dataStoreName).get(w).onsuccess=function(h){i.callback&&i.callback(h.target.result,w)}}p("audioBlob"),p("videoBlob"),p("gifBlob")}d.onerror=i.onError,d.onsuccess=function(){if(a=d.result,a.onerror=i.onError,a.setVersion)if(a.version!==e){var r=a.setVersion(e);r.onsuccess=function(){s(a),c()}}else c();else c()},d.onupgradeneeded=function(r){s(r.target.result)}},Fetch:function(i){return this.callback=i,this.init(),this},Store:function(i){return this.audioBlob=i.audioBlob,this.videoBlob=i.videoBlob,this.gifBlob=i.gifBlob,this.init(),this},onError:function(i){console.error(JSON.stringify(i,null,"	"))},dataStoreName:"recordRTC",dbName:null};typeof f<"u"&&(f.DiskStorage=de);/**
 * GifRecorder is standalone calss used by {@link RecordRTC} to record video or canvas into animated gif.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GifRecorder
 * @class
 * @example
 * var recorder = new GifRecorder(mediaStream || canvas || context, { onGifPreview: function, onGifRecordingStarted: function, width: 1280, height: 720, frameRate: 200, quality: 10 });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     img.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object or HTMLCanvasElement or CanvasRenderingContext2D.
 * @param {object} config - {disableLogs:true, initCallback: function, width: 320, height: 240, frameRate: 200, quality: 10}
 */function Fe(i,e){if(typeof GIFEncoder>"u"){var t=document.createElement("script");t.src="https://www.webrtc-experiment.com/gif-recorder.js",(document.body||document.documentElement).appendChild(t)}e=e||{};var a=i instanceof CanvasRenderingContext2D||i instanceof HTMLCanvasElement;this.record=function(){if(typeof GIFEncoder>"u"){setTimeout(g.record,1e3);return}if(!p){setTimeout(g.record,1e3);return}a||(e.width||(e.width=w.offsetWidth||320),e.height||(e.height=w.offsetHeight||240),e.video||(e.video={width:e.width,height:e.height}),e.canvas||(e.canvas={width:e.width,height:e.height}),c.width=e.canvas.width||320,c.height=e.canvas.height||240,w.width=e.video.width||320,w.height=e.video.height||240),m=new GIFEncoder,m.setRepeat(0),m.setDelay(e.frameRate||200),m.setQuality(e.quality||10),m.start(),typeof e.onGifRecordingStarted=="function"&&e.onGifRecordingStarted();function l(C){if(g.clearedRecordedData!==!0){if(d)return setTimeout(function(){l(C)},100);h=F(l),typeof b===void 0&&(b=C),!(C-b<90)&&(!a&&w.paused&&w.play(),a||r.drawImage(w,0,0,c.width,c.height),e.onGifPreview&&e.onGifPreview(c.toDataURL("image/png")),m.addFrame(r),b=C)}}h=F(l),e.initCallback&&e.initCallback()},this.stop=function(l){l=l||function(){},h&&J(h),this.blob=new Blob([new Uint8Array(m.stream().bin)],{type:"image/gif"}),l(this.blob),m.stream().bin=[]};var d=!1;this.pause=function(){d=!0},this.resume=function(){d=!1},this.clearRecordedData=function(){g.clearedRecordedData=!0,s()};function s(){m&&(m.stream().bin=[])}this.name="GifRecorder",this.toString=function(){return this.name};var c=document.createElement("canvas"),r=c.getContext("2d");a&&(i instanceof CanvasRenderingContext2D?(r=i,c=r.canvas):i instanceof HTMLCanvasElement&&(r=i.getContext("2d"),c=i));var p=!0;if(!a){var w=document.createElement("video");w.muted=!0,w.autoplay=!0,w.playsInline=!0,p=!1,w.onloadedmetadata=function(){p=!0},te(i,w),w.play()}var h=null,b,m,g=this}typeof f<"u"&&(f.GifRecorder=Fe);function He(i,e){var t="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(n){typeof f<"u"||n&&(typeof window<"u"||typeof U>"u"||(U.navigator={userAgent:t,getUserMedia:function(){}},U.console||(U.console={}),(typeof U.console.log>"u"||typeof U.console.error>"u")&&(U.console.error=U.console.log=U.console.log||function(){console.log(arguments)}),typeof document>"u"&&(n.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var u={getContext:function(){return u},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return u},n.HTMLVideoElement=function(){}),typeof location>"u"&&(n.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(n.screen={width:0,height:0}),typeof w>"u"&&(n.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),n.window=U))})(typeof U<"u"?U:null),e=e||"multi-streams-mixer";var a=[],d=!1,s=document.createElement("canvas"),c=s.getContext("2d");s.style.opacity=0,s.style.position="absolute",s.style.zIndex=-1,s.style.top="-1000em",s.style.left="-1000em",s.className=e,(document.body||document.documentElement).appendChild(s),this.disableLogs=!1,this.frameInterval=10,this.width=360,this.height=240,this.useGainNode=!0;var r=this,p=window.AudioContext;typeof p>"u"&&(typeof webkitAudioContext<"u"&&(p=webkitAudioContext),typeof mozAudioContext<"u"&&(p=mozAudioContext));var w=window.URL;typeof w>"u"&&typeof webkitURL<"u"&&(w=webkitURL),typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var h=window.MediaStream;typeof h>"u"&&typeof webkitMediaStream<"u"&&(h=webkitMediaStream),typeof h<"u"&&typeof h.prototype.stop>"u"&&(h.prototype.stop=function(){this.getTracks().forEach(function(n){n.stop()})});var b={};typeof p<"u"?b.AudioContext=p:typeof webkitAudioContext<"u"&&(b.AudioContext=webkitAudioContext);function m(n,u){"srcObject"in u?u.srcObject=n:"mozSrcObject"in u?u.mozSrcObject=n:u.srcObject=n}this.startDrawingFrames=function(){g()};function g(){if(!d){var n=a.length,u=!1,y=[];if(a.forEach(function(M){M.stream||(M.stream={}),M.stream.fullcanvas?u=M:y.push(M)}),u)s.width=u.stream.width,s.height=u.stream.height;else if(y.length){s.width=n>1?y[0].width*2:y[0].width;var R=1;(n===3||n===4)&&(R=2),(n===5||n===6)&&(R=3),(n===7||n===8)&&(R=4),(n===9||n===10)&&(R=5),s.height=y[0].height*R}else s.width=r.width||360,s.height=r.height||240;u&&u instanceof HTMLVideoElement&&l(u),y.forEach(function(M,A){l(M,A)}),setTimeout(g,r.frameInterval)}}function l(n,u){if(!d){var y=0,R=0,M=n.width,A=n.height;u===1&&(y=n.width),u===2&&(R=n.height),u===3&&(y=n.width,R=n.height),u===4&&(R=n.height*2),u===5&&(y=n.width,R=n.height*2),u===6&&(R=n.height*3),u===7&&(y=n.width,R=n.height*3),typeof n.stream.left<"u"&&(y=n.stream.left),typeof n.stream.top<"u"&&(R=n.stream.top),typeof n.stream.width<"u"&&(M=n.stream.width),typeof n.stream.height<"u"&&(A=n.stream.height),c.drawImage(n,y,R,M,A),typeof n.stream.onRender=="function"&&n.stream.onRender(c,y,R,M,A,u)}}function C(){d=!1;var n=k(),u=o();return u&&u.getTracks().filter(function(y){return y.kind==="audio"}).forEach(function(y){n.addTrack(y)}),i.forEach(function(y){y.fullcanvas}),n}function k(){S();var n;"captureStream"in s?n=s.captureStream():"mozCaptureStream"in s?n=s.mozCaptureStream():r.disableLogs||console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");var u=new h;return n.getTracks().filter(function(y){return y.kind==="video"}).forEach(function(y){u.addTrack(y)}),s.stream=u,u}function o(){b.AudioContextConstructor||(b.AudioContextConstructor=new b.AudioContext),r.audioContext=b.AudioContextConstructor,r.audioSources=[],r.useGainNode===!0&&(r.gainNode=r.audioContext.createGain(),r.gainNode.connect(r.audioContext.destination),r.gainNode.gain.value=0);var n=0;if(i.forEach(function(u){if(u.getTracks().filter(function(R){return R.kind==="audio"}).length){n++;var y=r.audioContext.createMediaStreamSource(u);r.useGainNode===!0&&y.connect(r.gainNode),r.audioSources.push(y)}}),!!n)return r.audioDestination=r.audioContext.createMediaStreamDestination(),r.audioSources.forEach(function(u){u.connect(r.audioDestination)}),r.audioDestination.stream}function v(n){var u=document.createElement("video");return m(n,u),u.className=e,u.muted=!0,u.volume=0,u.width=n.width||r.width||360,u.height=n.height||r.height||240,u.play(),u}this.appendStreams=function(n){if(!n)throw"First parameter is required.";n instanceof Array||(n=[n]),n.forEach(function(u){var y=new h;if(u.getTracks().filter(function(A){return A.kind==="video"}).length){var R=v(u);R.stream=u,a.push(R),y.addTrack(u.getTracks().filter(function(A){return A.kind==="video"})[0])}if(u.getTracks().filter(function(A){return A.kind==="audio"}).length){var M=r.audioContext.createMediaStreamSource(u);r.audioDestination=r.audioContext.createMediaStreamDestination(),M.connect(r.audioDestination),y.addTrack(r.audioDestination.stream.getTracks().filter(function(A){return A.kind==="audio"})[0])}i.push(y)})},this.releaseStreams=function(){a=[],d=!0,r.gainNode&&(r.gainNode.disconnect(),r.gainNode=null),r.audioSources.length&&(r.audioSources.forEach(function(n){n.disconnect()}),r.audioSources=[]),r.audioDestination&&(r.audioDestination.disconnect(),r.audioDestination=null),r.audioContext&&r.audioContext.close(),r.audioContext=null,c.clearRect(0,0,s.width,s.height),s.stream&&(s.stream.stop(),s.stream=null)},this.resetVideoStreams=function(n){n&&!(n instanceof Array)&&(n=[n]),S(n)};function S(n){a=[],n=n||i,n.forEach(function(u){if(u.getTracks().filter(function(R){return R.kind==="video"}).length){var y=v(u);y.stream=u,a.push(y)}})}this.name="MultiStreamsMixer",this.toString=function(){return this.name},this.getMixedStream=C}typeof f>"u"&&(T.exports=He);/**
 * MultiStreamRecorder can record multiple videos in single container.
 * @summary Multi-videos recorder.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MultiStreamRecorder
 * @class
 * @example
 * var options = {
 *     mimeType: 'video/webm'
 * }
 * var recorder = new MultiStreamRecorder(ArrayOfMediaStreams, options);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStreams} mediaStreams - Array of MediaStreams.
 * @param {object} config - {disableLogs:true, frameInterval: 1, mimeType: "video/webm"}
 */function Ye(i,e){i=i||[];var t=this,a,d;e=e||{elementClass:"multi-streams-mixer",mimeType:"video/webm",video:{width:360,height:240}},e.frameInterval||(e.frameInterval=10),e.video||(e.video={}),e.video.width||(e.video.width=360),e.video.height||(e.video.height=240),this.record=function(){a=new He(i,e.elementClass||"multi-streams-mixer"),s().length&&(a.frameInterval=e.frameInterval||10,a.width=e.video.width||360,a.height=e.video.height||240,a.startDrawingFrames()),e.previewStream&&typeof e.previewStream=="function"&&e.previewStream(a.getMixedStream()),d=new q(a.getMixedStream(),e),d.record()};function s(){var c=[];return i.forEach(function(r){B(r,"video").forEach(function(p){c.push(p)})}),c}this.stop=function(c){d&&d.stop(function(r){t.blob=r,c(r),t.clearRecordedData()})},this.pause=function(){d&&d.pause()},this.resume=function(){d&&d.resume()},this.clearRecordedData=function(){d&&(d.clearRecordedData(),d=null),a&&(a.releaseStreams(),a=null)},this.addStreams=function(c){if(!c)throw"First parameter is required.";c instanceof Array||(c=[c]),i.concat(c),!(!d||!a)&&(a.appendStreams(c),e.previewStream&&typeof e.previewStream=="function"&&e.previewStream(a.getMixedStream()))},this.resetVideoStreams=function(c){a&&(c&&!(c instanceof Array)&&(c=[c]),a.resetVideoStreams(c))},this.getMixer=function(){return a},this.name="MultiStreamRecorder",this.toString=function(){return this.name}}typeof f<"u"&&(f.MultiStreamRecorder=Ye);/**
 * RecordRTCPromisesHandler adds promises support in {@link RecordRTC}. Try a {@link https://github.com/muaz-khan/RecordRTC/blob/master/simple-demos/RecordRTCPromisesHandler.html|demo here}
 * @summary Promises for {@link RecordRTC}
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCPromisesHandler
 * @class
 * @example
 * var recorder = new RecordRTCPromisesHandler(mediaStream, options);
 * recorder.startRecording()
 *         .then(successCB)
 *         .catch(errorCB);
 * // Note: You can access all RecordRTC API using "recorder.recordRTC" e.g. 
 * recorder.recordRTC.onStateChanged = function(state) {};
 * recorder.recordRTC.setRecordingDuration(5000);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 * @throws Will throw an error if "new" keyword is not used to initiate "RecordRTCPromisesHandler". Also throws error if first argument "MediaStream" is missing.
 * @requires {@link RecordRTC}
 */function et(i,e){if(!this)throw'Use "new RecordRTCPromisesHandler()"';if(typeof i>"u")throw'First argument "MediaStream" is required.';var t=this;t.recordRTC=new f(i,e),this.startRecording=function(){return new Promise(function(a,d){try{t.recordRTC.startRecording(),a()}catch(s){d(s)}})},this.stopRecording=function(){return new Promise(function(a,d){try{t.recordRTC.stopRecording(function(s){if(t.blob=t.recordRTC.getBlob(),!t.blob||!t.blob.size){d("Empty blob.",t.blob);return}a(s)})}catch(s){d(s)}})},this.pauseRecording=function(){return new Promise(function(a,d){try{t.recordRTC.pauseRecording(),a()}catch(s){d(s)}})},this.resumeRecording=function(){return new Promise(function(a,d){try{t.recordRTC.resumeRecording(),a()}catch(s){d(s)}})},this.getDataURL=function(a){return new Promise(function(d,s){try{t.recordRTC.getDataURL(function(c){d(c)})}catch(c){s(c)}})},this.getBlob=function(){return new Promise(function(a,d){try{a(t.recordRTC.getBlob())}catch(s){d(s)}})},this.getInternalRecorder=function(){return new Promise(function(a,d){try{a(t.recordRTC.getInternalRecorder())}catch(s){d(s)}})},this.reset=function(){return new Promise(function(a,d){try{a(t.recordRTC.reset())}catch(s){d(s)}})},this.destroy=function(){return new Promise(function(a,d){try{a(t.recordRTC.destroy())}catch(s){d(s)}})},this.getState=function(){return new Promise(function(a,d){try{a(t.recordRTC.getState())}catch(s){d(s)}})},this.blob=null,this.version="5.6.2"}typeof f<"u"&&(f.RecordRTCPromisesHandler=et);/**
 * WebAssemblyRecorder lets you create webm videos in JavaScript via WebAssembly. The library consumes raw RGBA32 buffers (4 bytes per pixel) and turns them into a webm video with the given framerate and quality. This makes it compatible out-of-the-box with ImageData from a CANVAS. With realtime mode you can also use webm-wasm for streaming webm videos.
 * @summary Video recording feature in Chrome, Firefox and maybe Edge.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WebAssemblyRecorder
 * @class
 * @example
 * var recorder = new WebAssemblyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {webAssemblyPath:'webm-wasm.wasm',workerPath: 'webm-worker.js', frameRate: 30, width: 1920, height: 1080, bitrate: 1024, realtime: true}
 */function De(i,e){(typeof ReadableStream>"u"||typeof WritableStream>"u")&&console.error("Following polyfill is strongly recommended: https://unpkg.com/@mattiasbuelens/web-streams-polyfill/dist/polyfill.min.js"),e=e||{},e.width=e.width||640,e.height=e.height||480,e.frameRate=e.frameRate||30,e.bitrate=e.bitrate||1200,e.realtime=e.realtime||!0;var t;function a(){return new ReadableStream({start:function(w){var h=document.createElement("canvas"),b=document.createElement("video"),m=!0;b.srcObject=i,b.muted=!0,b.height=e.height,b.width=e.width,b.volume=0,b.onplaying=function(){h.width=e.width,h.height=e.height;var g=h.getContext("2d"),l=1e3/e.frameRate,C=setInterval(function(){if(t&&(clearInterval(C),w.close()),m&&(m=!1,e.onVideoProcessStarted&&e.onVideoProcessStarted()),g.drawImage(b,0,0),w._controlledReadableStream.state!=="closed")try{w.enqueue(g.getImageData(0,0,e.width,e.height))}catch{}},l)},b.play()}})}var d;function s(w,h){if(!e.workerPath&&!h){t=!1,fetch("https://unpkg.com/webm-wasm@latest/dist/webm-worker.js").then(function(m){m.arrayBuffer().then(function(g){s(w,g)})});return}if(!e.workerPath&&h instanceof ArrayBuffer){var b=new Blob([h],{type:"text/javascript"});e.workerPath=I.createObjectURL(b)}e.workerPath||console.error("workerPath parameter is missing."),d=new Worker(e.workerPath),d.postMessage(e.webAssemblyPath||"https://unpkg.com/webm-wasm@latest/dist/webm-wasm.wasm"),d.addEventListener("message",function(m){m.data==="READY"?(d.postMessage({width:e.width,height:e.height,bitrate:e.bitrate||1200,timebaseDen:e.frameRate||30,realtime:e.realtime}),a().pipeTo(new WritableStream({write:function(g){if(t){console.error("Got image, but recorder is finished!");return}d.postMessage(g.data.buffer,[g.data.buffer])}}))):m.data&&(c||p.push(m.data))})}this.record=function(){p=[],c=!1,this.blob=null,s(i),typeof e.initCallback=="function"&&e.initCallback()};var c;this.pause=function(){c=!0},this.resume=function(){c=!1};function r(w){if(!d){w&&w();return}d.addEventListener("message",function(h){h.data===null&&(d.terminate(),d=null,w&&w())}),d.postMessage(null)}var p=[];this.stop=function(w){t=!0;var h=this;r(function(){h.blob=new Blob(p,{type:"video/webm"}),w(h.blob)})},this.name="WebAssemblyRecorder",this.toString=function(){return this.name},this.clearRecordedData=function(){p=[],c=!1,this.blob=null},this.blob=null}typeof f<"u"&&(f.WebAssemblyRecorder=De)})($e);var mt=$e.exports;const vt=pt(mt);function gt(T){let f,L;return{c(){f=we("div"),L=xe("test?")},l(D){f=ye(D,"DIV",{});var x=ke(f);L=Be(x,"test?"),x.forEach(Z)},m(D,x){Ae(D,f,x),ve(f,L)},d(D){D&&Z(f)}}}function bt(T){let f,L;return{c(){f=we("p"),L=xe("loading")},l(D){f=ye(D,"P",{});var x=ke(f);L=Be(x,"loading"),x.forEach(Z)},m(D,x){Ae(D,f,x),ve(f,L)},d(D){D&&Z(f)}}}function wt(T){let f;return{c(){f=xe("switch cam")},l(L){f=Be(L,"switch cam")},m(L,D){Ae(L,f,D)},d(L){L&&Z(f)}}}function yt(T){let f;return{c(){f=xe("smazat")},l(L){f=Be(L,"smazat")},m(L,D){Ae(L,f,D)},d(L){L&&Z(f)}}}function Rt(T){let f,L,D,x,K,F,oe,J,_,I,W,G,le,Q,he;function O(P,E){return P[2]===!0?bt:gt}let se=O(T),ee=se(T);function Me(P,E){return P[4]?yt:wt}let B=Me(T),te=B(T);return{c(){f=we("img"),D=Ve(),x=we("div"),K=we("div"),F=we("button"),ee.c(),J=Ve(),_=we("button"),I=xe("upload"),W=Ve(),G=we("button"),te.c(),this.h()},l(P){f=ye(P,"IMG",{id:!0,src:!0,class:!0,alt:!0}),D=_e(P),x=ye(P,"DIV",{class:!0});var E=ke(x);K=ye(E,"DIV",{class:!0});var ie=ke(K);F=ye(ie,"BUTTON",{class:!0});var q=ke(F);ee.l(q),q.forEach(Z),J=_e(ie),_=ye(ie,"BUTTON",{class:!0});var Re=ke(_);I=Be(Re,"upload"),Re.forEach(Z),ie.forEach(Z),W=_e(E),G=ye(E,"BUTTON",{class:!0});var Ce=ke(G);te.l(Ce),Ce.forEach(Z),E.forEach(Z),this.h()},h(){ae(f,"id","camera"),ft(f.src,L=T[5])||ae(f,"src",L),ae(f,"class","w-[100vw] bg-black/10 dark:bg-white/10 rounded-xl mb-4 object-cover aspect-[3/4]"),ae(f,"alt",""),ae(F,"class",oe="record-btn "+(T[3]&&"recording")+" "+(T[4]&&"recorded")),ae(_,"class","upload-btn"),ae(K,"class","record-btn-wrapper"),ae(G,"class",le=T[3]&&"disabled"),ae(x,"class","create-menu flex justify-around text-white")},m(P,E){Ae(P,f,E),T[9](f),Ae(P,D,E),Ae(P,x,E),ve(x,K),ve(K,F),ee.m(F,null),T[10](F),ve(K,J),ve(K,_),ve(_,I),ve(x,W),ve(x,G),te.m(G,null),Q||(he=[qe(F,"click",function(){Xe(T[3]?T[8]:T[7])&&(T[3]?T[8]:T[7]).apply(this,arguments)}),qe(_,"click",St),qe(G,"click",function(){Xe(T[4]?T[6]:flipCamera)&&(T[4]?T[6]:flipCamera).apply(this,arguments)})],Q=!0)},p(P,[E]){T=P,se!==(se=O(T))&&(ee.d(1),ee=se(T),ee&&(ee.c(),ee.m(F,null))),E&24&&oe!==(oe="record-btn "+(T[3]&&"recording")+" "+(T[4]&&"recorded"))&&ae(F,"class",oe),B!==(B=Me(T))&&(te.d(1),te=B(T),te&&(te.c(),te.m(G,null))),E&8&&le!==(le=T[3]&&"disabled")&&ae(G,"class",le)},i:Qe,o:Qe,d(P){P&&Z(f),T[9](null),P&&Z(D),P&&Z(x),ee.d(),T[10](null),te.d(),Q=!1,ct(he)}}}function Ct(){console.log("start camera")}function St(){}function Tt(T){navigator.mediaDevices.getUserMedia({video:!0}).then(function(f){T(f)}).catch(function(f){alert("Unable to capture your camera. Please check console logs."),console.error(f)})}function kt(T,f,L){let D,x,K=!1,F=!1,oe=!1,J="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=";console.log(D);function _(){L(4,oe=!1),D.setAttribute("src",J)}function I(){D.setAttribute("src",URL.createObjectURL(W.getBlob())),W.camera.stop(),W.destroy(),W=null}var W;function G(){x.classList.add("disabled"),L(2,K=!0),Tt(function(O){W=vt(O,{type:"gif",frameRate:10,quality:1,width:375,onGifRecordingStarted(){},onGifPreview(se){D.setAttribute("src",se),L(2,K=!1),L(3,F=!0)}}),W.startRecording(),W.camera=O,x.classList.remove("disabled")})}function le(){x.classList.add("disabled"),W.stopRecording(I),L(3,F=!1),L(4,oe=!0)}lt(()=>{Ct()});function Q(O){Ze[O?"unshift":"push"](()=>{D=O,L(0,D)})}function he(O){Ze[O?"unshift":"push"](()=>{x=O,L(1,x)})}return[D,x,K,F,oe,J,_,G,le,Q,he]}class Mt extends st{constructor(f){super(),dt(this,f,kt,Rt,ut,{})}}export{Mt as component,Lt as universal};
